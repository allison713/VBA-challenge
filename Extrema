Sub Button_Extremes()

    Call formatting
    Call Greatest_Percent
    Call Least_Percent
    Call Greatest_Volume
    
    
End Sub

Sub formatting()
    
    'Rename the top row of cells
    Worksheets("2018").Range("Q1").Value = "Ticker"
    Worksheets("2018").Range("R1").Value = "Value"
    Worksheets("2018").Range("P2").Value = "Greatest % Incr"
    Worksheets("2018").Range("P3").Value = "Greatest % Decr"
    Worksheets("2018").Range("P4").Value = "Greatest Volume"
    'Resize the rows
    Worksheets("2018").Range("R1").ColumnWidth = 9.86
    Worksheets("2018").Range("Q1").ColumnWidth = 5.71
    Worksheets("2018").Range("P1").ColumnWidth = 15.86
    'Color the table
    Worksheets("2018").Range("Q1:R1").Interior.ColorIndex = 15
    Worksheets("2018").Range("P2").Interior.ColorIndex = 15
    Worksheets("2018").Range("P3").Interior.ColorIndex = 48
    Worksheets("2018").Range("P4").Interior.ColorIndex = 16
    'Border on the table

End Sub

Sub Greatest_Percent()

    Dim ws As Worksheet
    Dim max As Double
        max = Worksheets("2018").Range("L2").Value
    Dim maxticker As String
    
    'Loop through each worksheet
    For Each ws In ActiveWorkbook.Worksheets
    
        'Define last row for each worksheet
        lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        'Loop through rows on each worksheet to find the maximum overall
        For i = 2 To lastrow
        
            If ws.Cells(i, 12).Value > max Then
                max = ws.Cells(i, 12).Value
                
                'Document the ticker where the max occurs
                maxticker = ws.Cells(i, 10).Value
                
            End If
        Next i
    Next ws
    
    'Document the maximum percent increase
    Worksheets("2018").Range("R2").Value = Format(max, "Percent")
    
    'Document the maximum ticker
    Worksheets("2018").Range("Q2").Value = maxticker

End Sub

Sub Least_Percent()

    Dim ws As Worksheet
    Dim min As Double
        min = Worksheets("2018").Range("L2").Value
    Dim minticker As String
    
    'Loop through each worksheet
    For Each ws In ActiveWorkbook.Worksheets
    
        'Define last row for each worksheet
        lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        'Loop through rows on each worksheet to find the maximum overall
        For i = 2 To lastrow
        
            If ws.Cells(i, 12).Value < min Then
                min = ws.Cells(i, 12).Value
                
                'Document the ticker where the max occurs
                minticker = ws.Cells(i, 10).Value
                
            End If
        Next i
    Next ws
    
    'Document the maximum percent increase
    Worksheets("2018").Range("R3").Value = Format(min, "Percent")
    
    'Document the maximum ticker
    Worksheets("2018").Range("Q3").Value = minticker

End Sub

Sub Greatest_Volume()

    Dim ws As Worksheet
    Dim max As Double
        max = Worksheets("2018").Range("M2").Value
    Dim maxticker As String
    
    'Loop through each worksheet
    For Each ws In ActiveWorkbook.Worksheets
    
        'Define last row for each worksheet
        lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row
        
        'Loop through rows on each worksheet to find the maximum overall
        For i = 2 To lastrow
        
            If ws.Cells(i, 13).Value > max Then
                max = ws.Cells(i, 13).Value
                
                'Document the ticker where the max occurs
                maxticker = ws.Cells(i, 10).Value
                
            End If
        Next i
    Next ws
    
    'Document the maximum percent increase
    Worksheets("2018").Range("R4").Value = max
    
    'Document the maximum ticker
    Worksheets("2018").Range("Q4").Value = maxticker

End Sub
